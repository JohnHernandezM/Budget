=LET(
  i, ROW()-ROW($G$7)+1,
  curr, INDEX($G$7:$G$49, i),
  endsTag, ISNUMBER(MATCH(RIGHT(curr,2),{" L"," M"," H"},0)),
  startsNum, ISNUMBER(--LEFT(curr,4)),
  rng, INDEX($G$7:$G$49, SEQUENCE(ROWS($G$7:$G$49)-i+1,1,i)),
  endpos, IFERROR(XMATCH(TRUE, ISNUMBER(MATCH(RIGHT(rng,2),{" L"," M"," H"},0)),0,1), ROWS(rng)),
  IF(AND(startsNum, NOT(endsTag)),
     TEXTJOIN(" ", TRUE, TAKE(rng, endpos)),
     curr
  )
)
