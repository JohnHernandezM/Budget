Sub DeleteSelectedTableRow()
    Dim ws As Worksheet
    Dim lo As ListObject
    Dim selRow As Range
    
    Set ws = ThisWorkbook.Worksheets("GALICIA VISA")
    
    ' Check if selection is inside a table
    For Each lo In ws.ListObjects
        If Not Intersect(Selection, lo.DataBodyRange) Is Nothing Then
            Set selRow = Selection.EntireRow
            
            ' Temporarily unprotect the sheet
            ws.Unprotect Password:=""
            
            ' Delete the selected row(s)
            selRow.Delete
            
            ' Reapply protection & dynamic locking
            UpdateGaliciaProtection
            
            Exit Sub
        End If
    Next lo
    
    MsgBox "Please select a row inside a table to delete.", vbInformation
End Sub
