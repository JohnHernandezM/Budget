Sub DeleteSelectedTableRow()
    Dim ws As Worksheet
    Dim lo As ListObject
    Dim selRow As Range
    
    Set ws = ThisWorkbook.Worksheets("GALICIA VISA")
    
    ' Check if selection is inside a table
    For Each lo In ws.ListObjects
        If Not Intersect(Selection, lo.DataBodyRange) Is Nothing Then
            Set selRow = Selection.EntireRow
            
            ' Temporarily unprotect the sheet
            ws.Unprotect Password:=""
            
            ' Delete the selected row(s)
            selRow.Delete
            
            ' Reapply protection & dynamic locking
            UpdateGaliciaProtection
            
            Exit Sub
        End If
    Next lo
    
    MsgBox "Please select a row inside a table to delete.", vbInformation
End Sub

Dim cMenuDelete As CommandBarButton

Sub AddDeleteTableRowMenu()
    On Error Resume Next
    ' Delete existing if exists
    RemoveDeleteTableRowMenu
    
    ' Add menu item to Cell context menu
    Set cMenuDelete = Application.CommandBars("Cell").Controls.Add(Type:=msoControlButton, Temporary:=True)
    With cMenuDelete
        .Caption = "Delete Table Row"
        .OnAction = "DeleteSelectedTableRow"
        .BeginGroup = True  ' optional: adds a separator
    End With
End Sub

Sub RemoveDeleteTableRowMenu()
    On Error Resume Next
    If Not cMenuDelete Is Nothing Then cMenuDelete.Delete
End Sub
